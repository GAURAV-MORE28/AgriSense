{"ast":null,"code":"/**\r\n * Admin Dashboard — Premium analytics with SVG charts, stat cards, and fraud alerts\r\n */import React,{useEffect,useState}from'react';import{useAuth}from'../contexts/AuthContext';import LoadingSpinner from'../components/LoadingSpinner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'http://localhost:4000/api/v1';/* ───── SVG Donut Chart Component ───── */const DonutChart=_ref=>{let{data}=_ref;const entries=Object.entries(data);const total=entries.reduce((sum,_ref2)=>{let[,v]=_ref2;return sum+v;},0)||1;const colors=['#3B82F6','#F59E0B','#8B5CF6','#10B981','#EF4444','#6366F1','#EC4899'];let cumulative=0;const slices=entries.map((_ref3,i)=>{let[status,count]=_ref3;const pct=count/total;const dashArray=pct*100;const dashOffset=-cumulative*100;cumulative+=pct;return{status,count,pct,dashArray,dashOffset,color:colors[i%colors.length]};});return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-36 h-36 flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 36 36\",className:\"w-full h-full transform -rotate-90\",children:slices.map((s,i)=>/*#__PURE__*/_jsx(\"circle\",{cx:\"18\",cy:\"18\",r:\"15.915\",fill:\"none\",stroke:s.color,strokeWidth:\"3.5\",strokeDasharray:\"\".concat(s.dashArray,\" \").concat(100-s.dashArray),strokeDashoffset:s.dashOffset,className:\"transition-all duration-700\"},i))}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 flex flex-col items-center justify-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl font-bold text-gray-900\",children:total}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:\"Total\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col gap-1.5\",children:slices.map((s,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-2.5 h-2.5 rounded-full flex-shrink-0\",style:{backgroundColor:s.color}}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-700\",children:s.status.replace(/_/g,' ')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 ml-auto font-medium\",children:s.count})]},i))})]});};/* ───── SVG Bar Chart Component ───── */const BarChart=_ref4=>{let{data}=_ref4;const max=Math.max(...data.map(d=>d.value),1);const colors=['#10B981','#34D399','#6EE7B7','#A7F3D0','#D1FAE5'];return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:data.map((item,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500 w-28 truncate text-right\",children:item.label}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-gray-100 rounded-full h-5 relative overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full rounded-full transition-all duration-700 ease-out\",style:{width:\"\".concat(item.value/max*100,\"%\"),backgroundColor:colors[i%colors.length],animationDelay:\"\".concat(i*100,\"ms\")}})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-bold text-gray-700 w-10 text-right\",children:item.value})]},i))});};/* ───── OCR Gauge Component ───── */const GaugeChart=_ref5=>{let{value}=_ref5;const angle=value/100*180;const color=value>=80?'#10B981':value>=60?'#F59E0B':'#EF4444';return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"relative w-32 h-16 overflow-hidden\",children:/*#__PURE__*/_jsxs(\"svg\",{viewBox:\"0 0 100 50\",className:\"w-full h-full\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M 5 50 A 45 45 0 0 1 95 50\",fill:\"none\",stroke:\"#E5E7EB\",strokeWidth:\"8\",strokeLinecap:\"round\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M 5 50 A 45 45 0 0 1 95 50\",fill:\"none\",stroke:color,strokeWidth:\"8\",strokeLinecap:\"round\",strokeDasharray:\"\".concat(angle/180*141.37,\" 141.37\"),className:\"transition-all duration-1000\"})]})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-3xl font-bold mt-1\",style:{color},children:[value,\"%\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500 mt-1\",children:\"OCR Success Rate\"})]});};/* ───── Stat Card Component ───── */const StatCard=_ref6=>{let{icon,label,value,trend,color}=_ref6;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl border border-gray-100 p-5 shadow-sm hover:shadow-md transition-all duration-300 group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-xl flex items-center justify-center text-lg \".concat(color),children:icon}),trend&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-medium text-green-600 bg-green-50 px-2 py-1 rounded-full\",children:trend})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900 group-hover:text-green-700 transition-colors\",children:value}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:label})]});};const AdminDashboard=()=>{var _metrics$overview$ocr,_metrics$overview$ocr2;const{token}=useAuth();const[metrics,setMetrics]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchMetrics=async()=>{if(!token){setError('Please login to access admin dashboard');setLoading(false);return;}try{const response=await fetch(\"\".concat(API_URL,\"/admin/metrics\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(!response.ok)throw new Error('Failed to fetch metrics');const data=await response.json();setMetrics(data);}catch(err){console.error(err);setError('Showing demo data — backend offline');setMetrics({overview:{total_users:127,total_profiles:104,total_applications:89,total_documents:213,ocr_success_rate:78,recent_applications_7d:23,avg_farmer_income:165000},applications_by_status:{SUBMITTED:34,RECEIVED:22,UNDER_REVIEW:18,APPROVED:12,REJECTED:3},top_states:[{state:'Maharashtra',count:42},{state:'Gujarat',count:23},{state:'Madhya Pradesh',count:18},{state:'Rajasthan',count:12},{state:'Karnataka',count:9}],top_schemes:[{scheme:'PM-KISAN Samman Nidhi',count:34},{scheme:'PM Fasal Bima Yojana',count:22},{scheme:'Kisan Credit Card',count:18},{scheme:'Soil Health Card',count:9},{scheme:'PM Krishi Sinchai Yojana',count:6}]});}finally{setLoading(false);}};fetchMetrics();},[token]);if(loading)return/*#__PURE__*/_jsx(LoadingSpinner,{});if(!metrics)return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto px-4 py-8\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600\",children:error})});return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 py-8 animate-fade-in\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900\",children:\"\\uD83D\\uDCCA Admin Dashboard\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mt-1\",children:\"Real-time platform analytics and insights\"})]}),error&&/*#__PURE__*/_jsx(\"span\",{className:\"bg-amber-50 border border-amber-200 text-amber-700 px-4 py-2 rounded-xl text-sm font-medium\",children:\"\\u26A0\\uFE0F Demo Mode\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8\",children:[/*#__PURE__*/_jsx(StatCard,{icon:\"\\uD83D\\uDC65\",label:\"Total Users\",value:metrics.overview.total_users,trend:\"\\u2191 Active\",color:\"bg-blue-50\"}),/*#__PURE__*/_jsx(StatCard,{icon:\"\\uD83D\\uDCDD\",label:\"Profiles Created\",value:metrics.overview.total_profiles,color:\"bg-green-50\"}),/*#__PURE__*/_jsx(StatCard,{icon:\"\\uD83D\\uDCC4\",label:\"Applications\",value:metrics.overview.total_applications,trend:\"+\".concat(metrics.overview.recent_applications_7d,\" this week\"),color:\"bg-purple-50\"}),/*#__PURE__*/_jsx(StatCard,{icon:\"\\uD83D\\uDCB0\",label:\"Avg Income\",value:\"\\u20B9\".concat(metrics.overview.avg_farmer_income.toLocaleString('en-IN')),color:\"bg-amber-50\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-3 gap-6 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm md:col-span-1\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold text-gray-900 mb-5\",children:\"Application Status\"}),/*#__PURE__*/_jsx(DonutChart,{data:metrics.applications_by_status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm md:col-span-1\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold text-gray-900 mb-5\",children:\"Top States\"}),/*#__PURE__*/_jsx(BarChart,{data:metrics.top_states.map(s=>({label:s.state,value:s.count}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm flex flex-col items-center justify-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold text-gray-900 mb-5 self-start\",children:\"Document AI\"}),/*#__PURE__*/_jsx(GaugeChart,{value:(_metrics$overview$ocr=metrics.overview.ocr_success_rate)!==null&&_metrics$overview$ocr!==void 0?_metrics$overview$ocr:0}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 flex gap-6 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-gray-900\",children:metrics.overview.total_documents}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Documents\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-green-600\",children:Math.round(metrics.overview.total_documents*((_metrics$overview$ocr2=metrics.overview.ocr_success_rate)!==null&&_metrics$overview$ocr2!==void 0?_metrics$overview$ocr2:0)/100)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Successful\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold text-gray-900 mb-5\",children:\"\\uD83C\\uDFC6 Most Applied Schemes\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid md:grid-cols-2 lg:grid-cols-3 gap-4\",children:metrics.top_schemes.map((s,i)=>{const badgeColors=['bg-yellow-100 text-yellow-800','bg-gray-100 text-gray-700','bg-amber-100 text-amber-800','bg-green-50 text-green-700','bg-blue-50 text-blue-700'];return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 p-4 bg-gray-50 rounded-xl hover:bg-green-50 transition-colors group\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"w-9 h-9 rounded-lg flex items-center justify-center text-sm font-bold \".concat(badgeColors[i]||badgeColors[4]),children:[\"#\",i+1]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold text-gray-900 truncate group-hover:text-green-700 transition-colors\",children:s.scheme}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500\",children:[s.count,\" applications\"]})]})]},i);})})]})]});};export default AdminDashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
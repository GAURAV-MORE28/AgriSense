{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import{useTranslation}from'react-i18next';import axios from'axios';import{useAuth}from'../contexts/AuthContext';import LoadingSpinner from'../components/LoadingSpinner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'http://localhost:4000/api/v1';const ApplicationStatus=()=>{const{applicationId}=useParams();const{t}=useTranslation();const navigate=useNavigate();const{token}=useAuth();const[application,setApplication]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchStatus=async()=>{if(!token||!applicationId)return;try{const response=await axios.get(\"\".concat(API_URL,\"/application/\").concat(applicationId,\"/status\"),{headers:{Authorization:\"Bearer \".concat(token)}});setApplication(response.data);}catch(err){console.error('Error fetching status:',err);setError('Failed to fetch application status');}finally{setLoading(false);}};if(token){fetchStatus();}else{// If not authenticated, maybe just show loading or unauthorized\n// For demo, we might want to redirect, but let's just wait for auth (handled by App/AuthContext usually)\nsetLoading(false);setError(\"Login required to view status\");}// Poll for updates every 5 seconds\nconst interval=setInterval(()=>{if(token)fetchStatus();},5000);return()=>clearInterval(interval);},[applicationId,token]);if(loading)return/*#__PURE__*/_jsx(LoadingSpinner,{});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto px-4 py-8 text-center text-red-600\",children:[/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"mt-4 btn-secondary\",children:\"Go Home\"})]});if(!application)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-3xl mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:t('status.title')||'Application Status'}),/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-sm font-semibold status-badge \".concat(application.status.toLowerCase()),children:application.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow overflow-hidden mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:\"Application ID\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-mono text-lg font-medium\",children:application.application_id}),application.gov_application_id&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:\"Govt Reference ID\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-mono text-medium text-gray-700\",children:application.gov_application_id})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:\"Scheme\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-semibold text-primary-700\",children:application.scheme_name})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 bg-gray-50\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold mb-6\",children:t('status.timeline')||'Tracking Timeline'}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6 relative before:absolute before:inset-0 before:ml-5 before:-translate-x-px md:before:mx-auto md:before:translate-x-0 before:h-full before:w-0.5 before:bg-gradient-to-b before:from-transparent before:via-gray-300 before:to-transparent\",children:application.status_history.map((update,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex items-center justify-between md:justify-normal md:odd:flex-row-reverse group is-active\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center w-10 h-10 rounded-full border border-white bg-green-500 shadow shrink-0 md:order-1 md:group-odd:-translate-x-1/2 md:group-even:translate-x-1/2 z-10 text-white font-bold\",children:\"\\u2713\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-[calc(100%-4rem)] md:w-[calc(50%-2.5rem)] p-4 rounded border border-gray-200 bg-white shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between space-x-2 mb-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-gray-900\",children:update.status.replace(/_/g,' ')}),/*#__PURE__*/_jsx(\"time\",{className:\"font-caveat font-medium text-indigo-500 text-sm\",children:new Date(update.timestamp).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-500 text-sm\",children:[update.message,/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 text-xs text-gray-400\",children:new Date(update.timestamp).toLocaleDateString()})]})]})]},idx))})]})]})]});};export default ApplicationStatus;","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","useTranslation","axios","useAuth","LoadingSpinner","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","ApplicationStatus","applicationId","t","navigate","token","application","setApplication","loading","setLoading","error","setError","fetchStatus","response","get","concat","headers","Authorization","data","err","console","interval","setInterval","clearInterval","className","children","onClick","status","toLowerCase","application_id","gov_application_id","scheme_name","status_history","map","update","idx","replace","Date","timestamp","toLocaleTimeString","hour","minute","message","toLocaleDateString"],"sources":["C:/Users/gmore/OneDrive/Desktop/Gaurav/krishi-ai/frontend/src/pages/ApplicationStatus.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axios from 'axios';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport LoadingSpinner from '../components/LoadingSpinner';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:4000/api/v1';\r\n\r\ninterface StatusUpdate {\r\n  status: string;\r\n  timestamp: string;\r\n  message: string;\r\n}\r\n\r\ninterface ApplicationData {\r\n  application_id: string;\r\n  scheme_name: string;\r\n  status: string;\r\n  status_history: StatusUpdate[];\r\n  gov_application_id?: string;\r\n}\r\n\r\nconst ApplicationStatus: React.FC = () => {\r\n  const { applicationId } = useParams<{ applicationId: string }>();\r\n  const { t } = useTranslation();\r\n  const navigate = useNavigate();\r\n  const { token } = useAuth();\r\n\r\n  const [application, setApplication] = useState<ApplicationData | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchStatus = async () => {\r\n      if (!token || !applicationId) return;\r\n\r\n      try {\r\n        const response = await axios.get(\r\n          `${API_URL}/application/${applicationId}/status`,\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n        setApplication(response.data);\r\n      } catch (err) {\r\n        console.error('Error fetching status:', err);\r\n        setError('Failed to fetch application status');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (token) {\r\n      fetchStatus();\r\n    } else {\r\n      // If not authenticated, maybe just show loading or unauthorized\r\n      // For demo, we might want to redirect, but let's just wait for auth (handled by App/AuthContext usually)\r\n      setLoading(false);\r\n      setError(\"Login required to view status\");\r\n    }\r\n\r\n    // Poll for updates every 5 seconds\r\n    const interval = setInterval(() => {\r\n      if (token) fetchStatus();\r\n    }, 5000);\r\n\r\n    return () => clearInterval(interval);\r\n\r\n  }, [applicationId, token]);\r\n\r\n  if (loading) return <LoadingSpinner />;\r\n\r\n  if (error) return (\r\n    <div className=\"max-w-2xl mx-auto px-4 py-8 text-center text-red-600\">\r\n      <p>{error}</p>\r\n      <button onClick={() => navigate('/')} className=\"mt-4 btn-secondary\">Go Home</button>\r\n    </div>\r\n  );\r\n\r\n  if (!application) return null;\r\n\r\n  return (\r\n    <div className=\"max-w-3xl mx-auto px-4 py-8\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <h1 className=\"text-2xl font-bold text-gray-900\">{t('status.title') || 'Application Status'}</h1>\r\n        <span className={`px-3 py-1 rounded-full text-sm font-semibold status-badge ${application.status.toLowerCase()}`}>\r\n          {application.status}\r\n        </span>\r\n      </div>\r\n\r\n      <div className=\"bg-white rounded-lg shadow overflow-hidden mb-6\">\r\n        <div className=\"p-6 border-b\">\r\n          <p className=\"text-gray-500 text-sm\">Application ID</p>\r\n          <p className=\"font-mono text-lg font-medium\">{application.application_id}</p>\r\n          {application.gov_application_id && (\r\n            <div className=\"mt-2\">\r\n              <p className=\"text-gray-500 text-sm\">Govt Reference ID</p>\r\n              <p className=\"font-mono text-medium text-gray-700\">{application.gov_application_id}</p>\r\n            </div>\r\n          )}\r\n          <div className=\"mt-4\">\r\n            <p className=\"text-gray-500 text-sm\">Scheme</p>\r\n            <p className=\"text-xl font-semibold text-primary-700\">{application.scheme_name}</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-6 bg-gray-50\">\r\n          <h2 className=\"text-lg font-semibold mb-6\">{t('status.timeline') || 'Tracking Timeline'}</h2>\r\n\r\n          <div className=\"space-y-6 relative before:absolute before:inset-0 before:ml-5 before:-translate-x-px md:before:mx-auto md:before:translate-x-0 before:h-full before:w-0.5 before:bg-gradient-to-b before:from-transparent before:via-gray-300 before:to-transparent\">\r\n            {application.status_history.map((update, idx) => (\r\n              <div key={idx} className=\"relative flex items-center justify-between md:justify-normal md:odd:flex-row-reverse group is-active\">\r\n\r\n                {/* Icon */}\r\n                <div className=\"flex items-center justify-center w-10 h-10 rounded-full border border-white bg-green-500 shadow shrink-0 md:order-1 md:group-odd:-translate-x-1/2 md:group-even:translate-x-1/2 z-10 text-white font-bold\">\r\n                  âœ“\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"w-[calc(100%-4rem)] md:w-[calc(50%-2.5rem)] p-4 rounded border border-gray-200 bg-white shadow-sm\">\r\n                  <div className=\"flex items-center justify-between space-x-2 mb-1\">\r\n                    <div className=\"font-bold text-gray-900\">{update.status.replace(/_/g, ' ')}</div>\r\n                    <time className=\"font-caveat font-medium text-indigo-500 text-sm\">\r\n                      {new Date(update.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                    </time>\r\n                  </div>\r\n                  <div className=\"text-gray-500 text-sm\">\r\n                    {update.message}\r\n                    <div className=\"mt-1 text-xs text-gray-400\">\r\n                      {new Date(update.timestamp).toLocaleDateString()}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ApplicationStatus;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}